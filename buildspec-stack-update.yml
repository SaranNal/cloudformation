version: 0.2
phases:
  build:
    commands:
      - echo "Executing change set for helper-stack"
      - aws cloudformation execute-change-set --stack-name helper-stack-${StackENV} --change-set-name helper-stack-changeset
      - aws cloudformation wait stack-update-complete --stack-name helper-stack-${StackENV}

      - echo "Executing change set for network-stack"
      - aws cloudformation execute-change-set --stack-name network-stack-${StackENV} --change-set-name network-stack-changeset
      - aws cloudformation wait stack-update-complete --stack-name network-stack-${StackENV}

      - echo "Executing change set for infra-stack"
      - aws cloudformation execute-change-set --stack-name infra-stack-${StackENV} --change-set-name infra-stack-changeset
      - aws cloudformation wait stack-update-complete --stack-name infra-stack-${StackENV}

artifacts:
  files:
    - "**/*"
